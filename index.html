<!DOCTYPE html>
<html>
<body style="background:black;color:white;text-align:center;padding-top:100px;">

<h1>ðŸ”¥ Drake AI</h1>
<p id="status">Sleeping...</p>

<script>

const A4F_API_KEY = "ddc-a4f-c964629239ac4b1eba7b5a8a57e94a38";

const SpeechRecognition =
    window.SpeechRecognition || window.webkitSpeechRecognition;

const recognition = new SpeechRecognition();

recognition.continuous = true;
recognition.interimResults = false;
recognition.lang = "en-US";

let isAwake = false;

const statusText = document.getElementById("status");

function speak(text) {
    const utter = new SpeechSynthesisUtterance(text);
    speechSynthesis.speak(utter);
}

recognition.onresult = async (event) => {

    const transcript = event.results[event.results.length - 1][0].transcript.toLowerCase();

    console.log("Heard:", transcript);

    if (!isAwake) {

        if (transcript.includes("drake")) {
            isAwake = true;
            statusText.innerText = "Awake. Listening for command...";
            speak("Yes boss?");
        }

    } else {

        statusText.innerText = "Processing...";

        const reply = await callAI(transcript);

        speak(reply);

        isAwake = false;
        statusText.innerText = "Sleeping...";
    }
};

recognition.onerror = () => {
    recognition.start();
};

recognition.onend = () => {
    recognition.start();
};

async function callAI(message) {

    try {
        const response = await fetch("https://api.a4f.co/v1/chat/completions", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Authorization": "Bearer " + A4F_API_KEY
            },
            body: JSON.stringify({
                model: "provider-3/gpt-4o-mini",
                messages: [
                    { role: "system", content: "You are Drake, a smart voice assistant." },
                    { role: "user", content: message }
                ]
            })
        });

        const data = await response.json();
        return data.choices[0].message.content;

    } catch (err) {
        return "API error.";
    }
}

recognition.start();

</script>

</body>
</html>
